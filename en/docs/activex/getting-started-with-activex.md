---
title: "Getting started with activex"
slug: "getting-started-with-activex"
draft: false
images: []
weight: 1
type: docs
toc: true
---

## First ActiveX creation guide in Visual Studio C#
**Creation Steps**

 1. Start Visual&nbsp;Studio&nbsp;2013 as administrator
 2. Install Visual Studio extension [Microsoft Visual Studio Installer Projects][1]
 3. Create a class library project (WinFormActivex)
 4. Create your example window form (MainWindow)
 5. Create a new component interface(ILauncher)
 6. Create a new security interface (IObjectSafety)
 7. Create the component control (Launcher) that implement interfaces and launch the window.
 8. Check that all GUIDs are generated by you
 9. Check that the project is marked for COM
 10. Create the setup project (LauncherInstaller) with the primary output of WinFormActivex with the property `Register = vsdrpCOM`
 11. Install LauncherInstaller
 12. Run your test page in explorer (test.html)

**MainWindow**
You can create a normal Form, here is pre-generated.

    public partial class MainWindow : Form
    {
        public MainWindow()
        {
            InitializeComponent();
        }

        /// <summary>
        /// Required designer variable.
        /// </summary>
        private System.ComponentModel.IContainer components = null;

        /// <summary>
        /// Clean up any resources being used.
        /// </summary>
        /// <param name="disposing">true if managed resources should be disposed; otherwise, false.</param>
        protected override void Dispose(bool disposing)
        {
            if (disposing && (components != null))
            {
                components.Dispose();
            }
            base.Dispose(disposing);
        }

        #region Windows Form Designer generated code

        /// <summary>
        /// Required method for Designer support - do not modify
        /// the contents of this method with the code editor.
        /// </summary>
        private void InitializeComponent()
        {
            this.textBox1 = new System.Windows.Forms.TextBox();
            this.textBox2 = new System.Windows.Forms.TextBox();
            this.SuspendLayout();
            //
            // textBox1
            //
            this.textBox1.Location = new System.Drawing.Point(42, 23);
            this.textBox1.Name = "textBox1";
            this.textBox1.Size = new System.Drawing.Size(100, 20);
            this.textBox1.TabIndex = 0;
            //
            // textBox2
            //
            this.textBox2.Location = new System.Drawing.Point(42, 65);
            this.textBox2.Name = "textBox2";
            this.textBox2.Size = new System.Drawing.Size(100, 20);
            this.textBox2.TabIndex = 0;
            //
            // MainWindow
            //
            this.AutoScaleDimensions = new System.Drawing.SizeF(6F, 13F);
            this.AutoScaleMode = System.Windows.Forms.AutoScaleMode.Font;
            this.ClientSize = new System.Drawing.Size(284, 261);
            this.Controls.Add(this.textBox2);
            this.Controls.Add(this.textBox1);
            this.Name = "MainWindow";
            this.Text = "MainWindow";
            this.ResumeLayout(false);
            this.PerformLayout();

        }

        #endregion

        private System.Windows.Forms.TextBox textBox1;
        private System.Windows.Forms.TextBox textBox2;
    }

**ILauncher**

    using System.Runtime.InteropServices;
    namespace WinFormActivex
    {
        [ComVisible(true)]
        [InterfaceType(ComInterfaceType.InterfaceIsDual)]
        [Guid("94D26775-05E0-4B9C-BC73-C06FE915CF89")]
        public interface ILauncher
        {
            void ShowWindow();
        }
    }

**IObjectSafety**

    [ComImport()]
    [Guid("51105418-2E5C-4667-BFD6-50C71C5FD15C")]
    [InterfaceType(ComInterfaceType.InterfaceIsIUnknown)]
    interface IObjectSafety
    {
        [PreserveSig()]
        int GetInterfaceSafetyOptions(ref Guid riid, out int pdwSupportedOptions, out int pdwEnabledOptions);
        [PreserveSig()]
        int SetInterfaceSafetyOptions(ref Guid riid, int dwOptionSetMask, int dwEnabledOptions);
        }

**Launcher**
Please generate your GUID here.

     [ComVisible(true)]
     [ClassInterface(ClassInterfaceType.None)]
     [Guid("D100C392-030A-411C-92B6-4DBE9AC7AA5A")]
     [ProgId("WinFormActivex.Launcher")]
     [ComDefaultInterface(typeof(ILauncher))]
     public class Launcher : UserControl, ILauncher, IObjectSafety
     {
         #region [ ILauncher ]

         public void ShowWindow()
         {
             var f = new MainWindow();
             f.StartPosition = FormStartPosition.Manual;
             f.Location = Screen.AllScreens[0].Bounds.Location;
             f.WindowState = FormWindowState.Normal;
             f.WindowState = FormWindowState.Maximized;
             f.ShowInTaskbar = false;
             f.Show();
         }

         #endregion

         #region [ IObjectSafety ]

         public enum ObjectSafetyOptions
         {
             INTERFACESAFE_FOR_UNTRUSTED_CALLER = 0x00000001,
             INTERFACESAFE_FOR_UNTRUSTED_DATA = 0x00000002,
             INTERFACE_USES_DISPEX = 0x00000004,
             INTERFACE_USES_SECURITY_MANAGER = 0x00000008
         };

         public int GetInterfaceSafetyOptions(ref Guid riid, out int pdwSupportedOptions, out int pdwEnabledOptions)
         {
             ObjectSafetyOptions m_options = ObjectSafetyOptions.INTERFACESAFE_FOR_UNTRUSTED_CALLER | ObjectSafetyOptions.INTERFACESAFE_FOR_UNTRUSTED_DATA;
             pdwSupportedOptions = (int)m_options;
             pdwEnabledOptions = (int)m_options;
             return 0;
         }

         public int SetInterfaceSafetyOptions(ref Guid riid, int dwOptionSetMask, int dwEnabledOptions)
         {
             return 0;
         }

         #endregion
     }

**test.html**
Please check that your CLSID match (Launcher) GUID.

    <html>
        <head>
            <objectname="activexLauncher" style='display:none' id='activexLauncher' classid='CLSID:D100C392-030A-411C-92B6-4DBE9AC7AA5A' codebase='WinFormActivex'></object>
          <script language="javascript">
            <!-- Load the ActiveX object  -->
            var x = new ActiveXObject("WinFormActivex.Launcher");
            alert(x.GetText());
          </script>
        </head>
        <body>
        </body>
    </html>


**References**

 - [Stack Overflow question I always use as reference][2]
 - [Activex tag you should read][3]
 - [Old Microsoft guide][4]
 - [Article on creating the acrivex control with security options][5]
 - [Article about creating the window][6]

  [1]: http://visualstudiogallery.msdn.microsoft.com/9abe329c-9bba-44a1-be59-0fbf6151054d
  [2]: https://stackoverflow.com/questions/3360160/how-do-i-create-an-activex-com-in-c
  [3]: https://stackoverflow.com/tags/activex/info
  [4]: http://msdn.microsoft.com/en-us/library/ms973200.aspx
  [5]: http://haseebakhtar.wordpress.com/2011/05/31/creating-an-activex-control-in-net-using-c/
  [6]: http://www.c-sharpcorner.com/UploadFile/jayendra/how-to-create-activex-control/


